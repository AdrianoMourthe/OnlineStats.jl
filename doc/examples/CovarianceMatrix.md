
# CovarianceMatrix


````julia
using OnlineStats
using Gadfly
````





### Create covariance matrix with the first batch
````julia
obj = CovarianceMatrix(10 * randn(100, 10))
````





### Update model with many batches
````julia
for i = 1:10000
    update!(obj, 10 * randn(100, 10))
end
````





### Check estimate
````julia
julia> state(obj)
10x10 Array{Float64,2}:
 99.6293      -0.0154037   -0.0609252   …   -0.222839      0.15146  
 -0.0154037  100.259       -0.180831         0.018043     -0.237663 
 -0.0609252   -0.180831   100.096           -0.0864265     0.0519768
 -0.063473     0.0431237   -0.0514347       -0.00757571   -0.0391455
  0.128077    -0.127011     0.031223        -0.081919     -0.0809067
  0.0895581   -0.0160841   -0.00520134  …    0.0109664    -0.0136044
  0.071761    -0.048406     0.0874738       -0.0902417    -0.0710062
 -0.137993    -0.112897     0.0558386       -0.0687822    -0.0202122
 -0.222839     0.018043    -0.0864265      100.086        -0.0463487
  0.15146     -0.237663     0.0519768       -0.0463487   100.012    

````




````julia
julia> state(obj, true)
10x10 Array{Float64,2}:
  1.0          -0.000154124  -0.000610093  …  -0.00223157    0.00151733 
 -0.000154124   1.0          -0.00180511       0.000180119  -0.00237342 
 -0.000610093  -0.00180511    1.0             -0.000863481   0.000519488
 -0.000636564   0.000431123  -0.00051463      -7.58025e-5   -0.000391835
  0.00128261   -0.00126793    0.000311948     -0.00081849   -0.000808676
  0.000896946  -0.00016058   -5.19712e-5   …   0.000109581  -0.000135991
  0.000718795  -0.000483335   0.00087414      -0.000901842  -0.000709872
 -0.00138177   -0.00112692    0.000557826     -0.000687165  -0.000202003
 -0.00223157    0.000180119  -0.000863481      1.0          -0.00046326 
  0.00151733   -0.00237342    0.000519488     -0.00046326    1.0        

julia> spy(state(obj, true))

````


![](figures/CovarianceMatrix_5_1.png)

