<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Online algorithms for statistics · OnlineStats.jl</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link href="assets/highlightjs/default.css" rel="stylesheet" type="text/css"/><link href="assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><h1>OnlineStats.jl</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" action="search.html"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li class="current"><a class="toctext" href="index.html">Online algorithms for statistics</a><ul class="internal"><li><a class="toctext" href="#Basics-1">Basics</a></li><li><a class="toctext" href="#Weighting-1">Weighting</a></li><li><a class="toctext" href="#Series-1">Series</a></li><li><a class="toctext" href="#Merging-Series-1">Merging Series</a></li><li><a class="toctext" href="#Callbacks-1">Callbacks</a></li><li><a class="toctext" href="#Low-Level-Details-1">Low Level Details</a></li></ul></li><li><a class="toctext" href="pages/types.html">What Can OnlineStats Do?</a></li><li><a class="toctext" href="pages/api.html">API</a></li></ul></nav><article id="docs"><header><nav><ul><li><a href="index.html">Online algorithms for statistics</a></li></ul><a class="edit-page" href="https://github.com/joshday/OnlineStats.jl/tree/aad51c64447f5d20f6d8a98aac14aab29c9e3c50/docs/src/index.md"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>Online algorithms for statistics</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="Online-algorithms-for-statistics-1" href="#Online-algorithms-for-statistics-1">Online algorithms for statistics</a></h1><p><strong>OnlineStats</strong> is a Julia package which provides online algorithms for statistical models.  Online algorithms are well suited for streaming data or when data is too large to hold in memory.  Observations are processed one at a time and all <strong>algorithms use O(1) memory</strong>.</p><h2><a class="nav-anchor" id="Basics-1" href="#Basics-1">Basics</a></h2><h3><a class="nav-anchor" id="Every-OnlineStat-is-a-type-1" href="#Every-OnlineStat-is-a-type-1">Every OnlineStat is a type</a></h3><pre><code class="language-julia">m = Mean()
v = Variance()</code></pre><h3><a class="nav-anchor" id="OnlineStats-are-grouped-by-[Series](@ref)-1" href="#OnlineStats-are-grouped-by-[Series](@ref)-1">OnlineStats are grouped by <a href="pages/api.html#OnlineStats.Series"><code>Series</code></a></a></h3><pre><code class="language-julia">s = Series(m, v)</code></pre><h3><a class="nav-anchor" id="Updating-a-Series-updates-the-OnlineStats-1" href="#Updating-a-Series-updates-the-OnlineStats-1">Updating a Series updates the OnlineStats</a></h3><pre><code class="language-julia">y = randn(100)

for yi in y
    fit!(s, yi)
end

# or more simply:
fit!(s, y)</code></pre><h2><a class="nav-anchor" id="Weighting-1" href="#Weighting-1">Weighting</a></h2><p>Series are parameterized by a <code>Weight</code> type that controls the influence the next observation has on the OnlineStats contained in the Series.</p><pre><code class="language-julia">s = Series(EqualWeight(), Mean())</code></pre><p>Consider how weights affect the influence the next observation has on an online mean.  Many OnlineStats have an update which takes this form:</p><div>\[\theta^{(t)} = (1-\gamma_t)\theta^{(t-1)} + \gamma_t x_t\]</div><table><tr><th>Constructor</th><th>Weight at Update <code>t</code></th></tr><tr><td><a href="pages/api.html#OnlineStats.EqualWeight"><code>EqualWeight()</code></a></td><td><code>γ(t) = 1 / t</code></td></tr><tr><td><a href="pages/api.html#OnlineStats.ExponentialWeight"><code>ExponentialWeight(λ)</code></a></td><td><code>γ(t) = λ</code></td></tr><tr><td><a href="pages/api.html#OnlineStats.BoundedEqualWeight"><code>BoundedEqualWeight(λ)</code></a></td><td><code>γ(t) = max(1 / t, λ)</code></td></tr><tr><td><a href="pages/api.html#OnlineStats.LearningRate"><code>LearningRate(r, λ)</code></a></td><td><code>γ(t) = max(1 / t ^ r, λ)</code></td></tr></table><p><img src="https://cloud.githubusercontent.com/assets/8075494/18796073/9c844b30-8195-11e6-89a1-7ad9b4d891f2.png" alt/></p><h2><a class="nav-anchor" id="Series-1" href="#Series-1">Series</a></h2><p>The <code>Series</code> type is the workhorse of OnlineStats.  A Series tracks</p><ol><li><p>The <code>Weight</code></p></li><li><p>An OnlineStat or tuple of OnlineStats.</p></li></ol><h3><a class="nav-anchor" id="Creating-a-Series-1" href="#Creating-a-Series-1">Creating a Series</a></h3><pre><code class="language-julia">Series(Mean())
Series(Mean(), Variance())

Series(ExponentialWeight(), Mean())
Series(ExponentialWeight(), Mean(), Variance())

y = randn(100)

Series(y, Mean())
Series(y, Mean(), Variance())

Series(y, ExponentialWeight(.01), Mean())
Series(y, ExponentialWeight(.01), Mean(), Variance())</code></pre><h3><a class="nav-anchor" id="Updating-a-Series-1" href="#Updating-a-Series-1">Updating a Series</a></h3><p>There are multiple ways to update the OnlineStats in a Series</p><ul><li><p>Single observation</p><ul><li><p>Note: A single observation is a vector for OnlineStats such as <code>CovMatrix</code></p></li></ul></li></ul><pre><code class="language-julia">s = Series(Mean())
fit!(s, randn())

s = Series(CovMatrix(4))
fit!(s, randn(4))
fit!(s, randn(4))</code></pre><ul><li><p>Single observation, override weight</p></li></ul><pre><code class="language-julia">s = Series(Mean())
fit!(s, randn(), rand())</code></pre><ul><li><p>Multiple observations</p><ul><li><p>Note: multiple observations are a matrix for OnlineStats such as <code>CovMatrix</code>.  By default, each <em>row</em> is considered an observation.  However, there exists <code>fit!</code> methods which use observations in <em>columns</em>.</p></li></ul></li></ul><pre><code class="language-julia">s = Series(Mean())
fit!(s, randn(100))

s = Series(CovMatrix(4))
fit!(s, randn(100, 4))                 # Observations in rows
fit!(s, randn(4, 100), ObsDim.Last())  # Observations in columns</code></pre><ul><li><p>Multiple observations, use the same weight for all</p></li></ul><pre><code class="language-julia">s = Series(Mean())
fit!(s, randn(100), .01)</code></pre><ul><li><p>Multiple observations, provide vector of weights</p></li></ul><pre><code class="language-julia">s = Series(Mean())
fit!(s, randn(100), rand(100))</code></pre><ul><li><p>Multiple observations, update in minibatches   OnlineStats which use stochastic approximation (<code>QuantileSGD</code>, <code>QuantileMM</code>, <code>KMeans</code>, etc.) have different behavior if they are updated in minibatches.  </p><pre><code class="language-julia">s = Series(QuantileSGD())
fit!(s, randn(1000), 7)</code></pre></li></ul><p><a href="#readme-contents">go to top</a></p><h2><a class="nav-anchor" id="Merging-Series-1" href="#Merging-Series-1">Merging Series</a></h2><p>Two Series can be merged if they track the same OnlineStats and those OnlineStats are mergeable.  The syntax for in-place merging is</p><pre><code class="language-julia">merge!(series1, series2, arg)</code></pre><p>Where <code>series1</code>/<code>series2</code> are Series that contain the same OnlineStats and <code>arg</code> is used to determine how <code>series2</code> should be merged into <code>series1</code>.</p><pre><code class="language-julia">using OnlineStats

y1 = randn(100)
y2 = randn(100)

s1 = Series(y1, Mean(), Variance())
s2 = Series(y2, Mean(), Variance())

# Treat s2 as a new batch of data.  Essentially:
# s1 = Series(Mean(), Variance()); fit!(s1, y1); fit!(s1, y2)
merge!(s1, s2, :append)

# Use weighted average based on nobs of each Series
merge!(s1, s2, :mean)

# Treat s2 as a single observation.
merge!(s1, s2, :singleton)

# Provide the ratio of influence s2 should have.
merge!(s1, s2, .5)</code></pre><h2><a class="nav-anchor" id="Callbacks-1" href="#Callbacks-1">Callbacks</a></h2><p>While an OnlineStat is being updated, you may wish to perform an action like print intermediate results to a log file or update a plot.  For this purpose, OnlineStats exports a <a href="pages/api.html#OnlineStats.maprows-Tuple{Function,Integer,Vararg{Any,N} where N}"><code>maprows</code></a> function.</p><p><code>maprows(f::Function, b::Integer, data...)</code></p><p><code>maprows</code> works similar to <code>Base.mapslices</code>, but maps <code>b</code> rows at a time.  It is best used with Julia&#39;s do block syntax.</p><h3><a class="nav-anchor" id="Example-1-1" href="#Example-1-1">Example 1</a></h3><ul><li><p>Input</p></li></ul><pre><code class="language-julia">y = randn(100)
s = Series(Mean())
maprows(20, y) do yi
    fit!(s, yi)
    info(&quot;value of mean is $(value(s))&quot;)
end</code></pre><ul><li><p>Output</p></li></ul><pre><code class="language-none">INFO: value of mean is 0.06340121912925167
INFO: value of mean is -0.06576995293439102
INFO: value of mean is 0.05374292238752276
INFO: value of mean is 0.008857939006120167
INFO: value of mean is 0.016199508928045905</code></pre><p><a href="#readme-contents">go to top</a></p><h2><a class="nav-anchor" id="Low-Level-Details-1" href="#Low-Level-Details-1">Low Level Details</a></h2><h3><a class="nav-anchor" id="OnlineStat{I,-O}-1" href="#OnlineStat{I,-O}-1"><code>OnlineStat{I, O}</code></a></h3><ul><li><p>The abstract type <code>OnlineStat</code> has two parameters:</p><ul><li><p><code>I</code>: The input dimension.  The size of one observation</p></li><li><p><code>O</code>: The output dimension/object.  The size/object of <code>value</code></p></li></ul></li><li><p>A Series can only manage OnlineStats that share the same input type <code>I</code>.  This is because when you call a method like <code>fit!(s, randn(100))</code>, the Series needs to know whether <code>randn(100)</code> should be treated as 100 scalar observations or a single vector observation.</p></li></ul><h3><a class="nav-anchor" id="fit!-and-value-1" href="#fit!-and-value-1"><code>fit!</code> and <code>value</code></a></h3><ul><li><p><code>fit!</code> updates the &quot;sufficient statistics&quot; of an OnlineStat, but does not necessarily update the parameter of interest.</p></li><li><p><code>value</code> creates the parameter of interest from the &quot;sufficient statistics&quot;</p></li><li><p>This is the convention in order to avoid extra computation costs when the <code>value</code> is not needed while updating a chunk of data.</p></li></ul><footer><hr/><a class="next" href="pages/types.html"><span class="direction">Next</span><span class="title">What Can OnlineStats Do?</span></a></footer></article></body></html>
